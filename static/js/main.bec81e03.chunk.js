(this.webpackJsonpBookStore=this.webpackJsonpBookStore||[]).push([[0],{171:function(e,t,n){e.exports=n(334)},294:function(e,t,n){},295:function(e,t,n){},296:function(e,t,n){},297:function(e,t,n){},313:function(e,t,n){},315:function(e,t,n){},316:function(e,t,n){},334:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(31),c=n.n(o),l=n(19),i=n(42),u=n(36),s=n(37),m=n(50),p=n(49),f=n(33),d=n(52),E=n.n(d),b=n(348),O=n(345),h=function(e){var t=e.books;return r.a.createElement(b.a.Column,{stretched:!0,width:13},r.a.createElement(O.a.Group,{itemsPerRow:4},t.map((function(e,t){return r.a.createElement(M,{key:t,book:e})}))))},g=n(342),y=(n(294),function(){return r.a.createElement(g.a,{active:!0,inline:"centered",className:"spinner"},"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...")}),C=n(346),k=(n(295),function(){return r.a.createElement(C.a,{negative:!0,compact:!0,className:"error-indicator"},r.a.createElement(C.a.Header,null,"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430!"),r.a.createElement("p",null,"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443..."))}),v=r.a.createContext(),S=v.Provider,I=v.Consumer,j=function(){return function(e){return function(t){return r.a.createElement(I,null,(function(n){return r.a.createElement(e,Object.assign({},t,{bookstoreService:n}))}))}}},T=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduceRight((function(e,t){return t(e)}),e)}},_=function(e){return{type:"SET_BOOKS",payload:e}},N=function(e){return function(){return function(t){t({type:"FETCH_BOOKS_REQUEST"}),e.getBooks().then((function(e){return t({type:"FETCH_BOOKS_SUCCESS",payload:e.data})})).catch((function(e){return t(function(e){return{type:"FETCH_BOOKS_FAILURE",payload:e}}(e))}))}}},B=function(e){Object(m.a)(n,e);var t=Object(p.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"componentDidMount",value:function(){this.props.fetchBooks()}},{key:"render",value:function(){var e=this.props,t=e.books,n=e.loading,a=e.error,o=e.onAddedToCart;return n?r.a.createElement(y,null):a?r.a.createElement(k,null):r.a.createElement(h,{books:t,onAddedToCart:o})}}]),n}(a.Component),R=function(e,t){switch(t){case"all":return e;case"popularity":return E()(e,"rating","desc");case"low-price":return E()(e,"price","asc");case"high-price":return E()(e,"price","desc");case"bookName":return E()(e,"title","asc");case"author":return E()(e,"author","asc");default:return e}},A=function(e,t){return 0===t.length?e:e.filter((function(e){return e.title.toLowerCase().indexOf(t)>-1||e.author.toLowerCase().indexOf(t)>-1}))},D=T(j(),Object(l.b)((function(e){var t=e.bookList,n=t.books,a=t.loading,r=t.error,o=e.filter,c=o.term,l=o.filterBy;return{books:n&&R(A(n,c.toLowerCase()),l),loading:a,error:r}}),(function(e,t){var n=t.bookstoreService;return Object(f.b)({fetchBooks:N(n)},e)})))(B),L=n(162),x=n(349),F=n(44),w=n(335),K=(n(296),function(e){var t=e.book,n=e.onAddedToCart,a=e.particularBook,o=t.id,c=t.title,l=t.author,i=t.price,u=t.image,s=t.rating;return r.a.createElement(O.a,null,r.a.createElement("div",{className:"cover-image"},r.a.createElement(L.a,{src:u,alt:"cover",ui:!0})),r.a.createElement(O.a.Content,null,r.a.createElement(O.a.Header,{className:"text-center"},c),r.a.createElement(O.a.Meta,{className:"mt7 text-center"},l)),r.a.createElement(O.a.Content,{extra:!0,className:"text-center"},"\u0420\u0435\u0439\u0442\u0438\u043d\u0433:\xa0\xa0",r.a.createElement(x.a,{icon:"star",rating:s,maxRating:5}),"\xa0\xa0",s," / 5"),r.a.createElement(O.a.Content,{extra:!0},r.a.createElement("div",{className:"text-center price-color"},r.a.createElement(F.a,{name:"rub"}),r.a.createElement("b",null,i))),r.a.createElement(w.a,{onClick:function(){return n(o)},color:"green"},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 \u043a\u043e\u0440\u0437\u0438\u043d\u0443 ",a?"(".concat(a.count,")"):null))}),H=function(e){return{type:"BOOK_ADDED_TO_CART",payload:e}},J=function(e,t,n){return{type:"UPDATE_SHOPPING_CART",payload:{cartItems:e,orderTotal:t,numItems:n}}},P={onAddedToCart:H},M=Object(l.b)((function(e,t){return{particularBook:e.shoppingCart.cartItems.filter((function(e){return e.id===t.book.id})).shift()}}),P)(K),U=n(347),G=n(343),V=(n(297),function(e){var t=e.term,n=e.onSearch;return r.a.createElement(U.a.Item,null,r.a.createElement(G.a,{icon:"search",fluid:!0,placeholder:"\u041d\u0430\u0439\u0442\u0438 \u043a\u043d\u0438\u0433\u0443...",value:t,onChange:function(e){return n(e.target.value)}}))}),z=function(e){return{type:"SET_FILTER",payload:e}},Q={onSearch:function(e){return{type:"BOOKS_SEARCH",payload:e}}},q=Object(l.b)((function(e){return{term:e.filter.term}}),Q)(V),W=(n(313),function(e){var t=e.numItems,n=e.orderTotal;return r.a.createElement("header",{className:"shop-header"},r.a.createElement(i.b,{to:"/"},r.a.createElement("div",{className:"logo text-dark"},"\u041a\u043d\u0438\u0436\u043d\u044b\u0439 \u043c\u0430\u0433\u0430\u0437\u0438\u043d")),r.a.createElement(i.b,{to:"/cart"},r.a.createElement(w.a,{animated:"vertical",color:"blue",className:"shopping-cart-button"},r.a.createElement(w.a.Content,{hidden:!0},"\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u0432 \u043a\u043e\u0440\u0437\u0438\u043d\u0443"),r.a.createElement(w.a.Content,{visible:!0},"[",t,"] \xa0- \xa0",r.a.createElement(F.a,{name:"shop"}),"\xa0 \u0418\u0442\u043e\u0433\u043e: ",r.a.createElement("b",null,n," \u0440\u0443\u0431.")))))}),X=Object(l.b)((function(e){var t=e.shoppingCart;return{numItems:t.numItems,orderTotal:t.orderTotal}}))(W),Y=n(16),Z=Object(Y.f)((function(e){var t=e.history;return r.a.createElement("button",{className:"btn btn-info",onClick:function(){return t.push("/")}},"\u0412\u0435\u0440\u043d\u0443\u0442\u044c\u0441\u044f \u043a \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0443")})),$=(n(315),function(e){var t=e.item,n=e.idx,a=e.onDecrease,o=e.onIncrease,c=e.onDelete,l=t.id,i=t.title,u=t.count,s=t.total;return r.a.createElement("tr",{key:l},r.a.createElement("td",null,n+1),r.a.createElement("td",null,i),r.a.createElement("td",null,r.a.createElement("button",{className:"btn btn-sm",onClick:function(){return a(l)}},r.a.createElement("i",{className:"fa fa-minus-circle"})),"\xa0\xa0",u,"\xa0\xa0",r.a.createElement("button",{className:"btn btn-sm",onClick:function(){return o(l)}},r.a.createElement("i",{className:"fa fa-plus-circle"}))),r.a.createElement("td",null,s," \u0440\u0443\u0431."),r.a.createElement("td",{className:"table-actions"},r.a.createElement("button",{className:"btn btn-outline-danger btn-sm",onClick:function(){return c(l)}},r.a.createElement("i",{className:"fa fa-trash-o"}))))}),ee=(n(316),function(e){var t=e.items,n=e.total,a=e.onIncrease,o=e.onDecrease,c=e.onDelete,l=e.onClearCart;return r.a.createElement("div",{className:"shopping-cart-table"},r.a.createElement("h2",null,"\u0412\u0430\u0448\u0430 \u043a\u043e\u0440\u0437\u0438\u043d\u0430:"),r.a.createElement("table",{className:"table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"\u2116"),r.a.createElement("th",null,"\u041a\u043d\u0438\u0433\u0430"),r.a.createElement("th",null,"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e"),r.a.createElement("th",null,"\u041e\u0431\u0449\u0430\u044f \u0441\u0443\u043c\u043c\u0430"),r.a.createElement("th",null,"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043a\u043d\u0438\u0433\u0443"))),r.a.createElement("tbody",null,t.map((function(e,t){return r.a.createElement($,{item:e,key:t,idx:t,onIncrease:a,onDecrease:o,onDelete:c})})))),r.a.createElement("div",{className:"total"},"\u0418\u0442\u043e\u0433\u043e: ",n," \u0440\u0443\u0431."),r.a.createElement("div",{className:"main-actions"},r.a.createElement(Z,null),r.a.createElement("button",{className:"btn btn-danger",onClick:function(){return l()}},"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u043a\u043e\u0440\u0437\u0438\u043d\u0443")))}),te={onIncrease:H,onDecrease:function(e){return{type:"BOOK_REMOVED_FROM_CART",payload:e}},onDelete:function(e){return{type:"ALL_BOOKS_REMOVED_FROM_CART",payload:e}},onClearCart:function(){return{type:"CLEAR_SHOPPING_CART"}}},ne=Object(l.b)((function(e){var t=e.shoppingCart;return{items:t.cartItems,total:t.orderTotal}}),te)((function(e){var t=e.items,n=e.total,a=e.onIncrease,o=e.onDecrease,c=e.onDelete,l=e.onClearCart;return 0===t.length?r.a.createElement("div",{className:"text-center empty-shopping-cart"},r.a.createElement("h3",null,"\u0412\u0430\u0448\u0430 \u043a\u043e\u0440\u0437\u0438\u043d\u0430 \u043f\u0443\u0441\u0442\u0430."),r.a.createElement("p",null,"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043d\u0443\u0436\u043d\u044b\u0439 \u0412\u0430\u043c \u0442\u043e\u0432\u0430\u0440 \u0438\u0437 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430 \u0438\u043d\u0442\u0435\u0440\u043d\u0435\u0442-\u043c\u0430\u0433\u0430\u0437\u0438\u043d\u0430 \u0438 \u0434\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u0435\u0433\u043e \u0432 \u043a\u043e\u0440\u0437\u0438\u043d\u0443."),r.a.createElement(Z,null)):r.a.createElement(ee,{items:t,total:n,onIncrease:a,onDecrease:o,onDelete:c,onClearCart:l})})),ae=function(e){var t=e.setFilter,n=e.filterBy;return r.a.createElement(b.a.Column,{width:3},r.a.createElement(q,null),r.a.createElement(U.a,{fluid:!0,tabular:!0,text:!0,vertical:!0},r.a.createElement(U.a.Item,{header:!0},"\u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e:"),r.a.createElement(U.a.Item,{active:"popularity"===n,onClick:function(){return t("popularity")}},"\u041f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u043e\u0441\u0442\u0438"),r.a.createElement(U.a.Item,{active:"low-price"===n,onClick:function(){return t("low-price")}},"\u0426\u0435\u043d\u0435 (\u0441\u043d\u0430\u0447\u0430\u043b\u0430 \u0434\u0435\u0448\u0435\u0432\u044b\u0435)"),r.a.createElement(U.a.Item,{active:"high-price"===n,onClick:function(){return t("high-price")}},"\u0426\u0435\u043d\u0435 (\u0441\u043d\u0430\u0447\u0430\u043b\u0430 \u0434\u043e\u0440\u043e\u0433\u0438\u0435)"),r.a.createElement(U.a.Item,{active:"bookName"===n,onClick:function(){return t("bookName")}},"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u044e \u043a\u043d\u0438\u0433\u0438"),r.a.createElement(U.a.Item,{active:"author"===n,onClick:function(){return t("author")}},"\u0410\u0432\u0442\u043e\u0440\u0443")),"all"===n||null===n?r.a.createElement(w.a,{disabled:!0,size:"small"},"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0443"):r.a.createElement(w.a,{onClick:function(){return t("all")},size:"small"},"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0443"))},re={setFilter:z},oe=Object(l.b)((function(e){return{filterBy:e.filter.filterBy}}),re)(ae),ce=[{path:"/",isExact:!0,component:function(){return r.a.createElement(b.a,null,r.a.createElement(oe,null),r.a.createElement(D,null))}},{path:"/cart",isExact:!1,component:function(){return r.a.createElement(ne,null)}},{path:"*",isExact:!1,component:function(){return r.a.createElement("h3",{className:"text-center"},"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430")}}],le=function(){return r.a.createElement("main",{role:"main",className:"container"},r.a.createElement(X,null),r.a.createElement(Y.c,null,ce.map((function(e){return r.a.createElement(Y.a,{key:e.path,exact:e.isExact,path:e.path,component:e.component})}))))},ie=function(e){Object(m.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(u.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).saveToLocalStorage=function(){localStorage.setItem("cartItems",JSON.stringify(e.props.cartItems)),localStorage.setItem("orderTotal",JSON.stringify(e.props.orderTotal)),localStorage.setItem("numItems",JSON.stringify(e.props.numItems)),localStorage.setItem("filterBy",JSON.stringify(e.props.filterBy)),localStorage.setItem("books",JSON.stringify(e.props.books))},e.getFromLocalStorage=function(){null!==JSON.parse(localStorage.getItem("cartItems"))&&e.props.updateShoppingCart(JSON.parse(localStorage.getItem("cartItems")),JSON.parse(localStorage.getItem("orderTotal")),JSON.parse(localStorage.getItem("numItems"))),"all"!==JSON.parse(localStorage.getItem("filterBy"))&&e.props.setFilter(JSON.parse(localStorage.getItem("filterBy"))),e.props.setBooks(JSON.parse(localStorage.getItem("books")))},e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){this.getFromLocalStorage()}},{key:"componentDidUpdate",value:function(){this.saveToLocalStorage()}},{key:"render",value:function(){return r.a.createElement(le,null)}}]),n}(a.Component),ue=Object(l.b)((function(e){var t=e.shoppingCart;return{cartItems:t.cartItems,orderTotal:t.orderTotal,numItems:t.numItems,filterBy:e.filter.filterBy,books:e.bookList.books}}),(function(e){return Object(f.b)({updateShoppingCart:J,setFilter:z,setBooks:_},e)}))(ie),se=function(e){Object(m.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(u.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={hasError:!1},e}return Object(s.a)(n,[{key:"componentDidCatch",value:function(){this.setState({hasError:!0})}},{key:"render",value:function(){return this.state.hasError?r.a.createElement(k,null):this.props.children}}]),n}(a.Component),me=n(160),pe=n.n(me),fe=function(){function e(){Object(u.a)(this,e)}return Object(s.a)(e,[{key:"getBooks",value:function(){return pe.a.get("./books.json")}}]),e}(),de=n(161),Ee=n(17),be=function(e,t){if(void 0===e)return{books:[],loading:!0,error:null};switch(t.type){case"FETCH_BOOKS_REQUEST":return Object(Ee.a)(Object(Ee.a)({},e.bookList),{},{books:[],loading:!0,error:null});case"FETCH_BOOKS_SUCCESS":return Object(Ee.a)(Object(Ee.a)({},e.bookList),{},{books:t.payload,loading:!1,error:null});case"FETCH_BOOKS_FAILURE":return Object(Ee.a)(Object(Ee.a)({},e.bookList),{},{books:[],loading:!1,error:t.payload});case"SET_BOOKS":return Object(Ee.a)(Object(Ee.a)({},e.bookList),{},{books:t.payload});default:return e.bookList}},Oe=n(54),he=function(e,t,n){return 0===t.count?[].concat(Object(Oe.a)(e.slice(0,n)),Object(Oe.a)(e.slice(n+1))):-1===n?[].concat(Object(Oe.a)(e),[t]):[].concat(Object(Oe.a)(e.slice(0,n)),[t],Object(Oe.a)(e.slice(n+1)))},ge=function(e,t,n){var a=e.bookList.books,r=e.shoppingCart.cartItems,o=a.find((function(e){return e.id===t})),c=r.findIndex((function(e){return e.id===t})),l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,a=t.id,r=void 0===a?e.id:a,o=t.count,c=void 0===o?0:o,l=t.title,i=void 0===l?e.title:l,u=t.total,s=void 0===u?0:u;return{id:r,title:i,count:c+n,total:s+n*e.price}}(o,r[c],n);return Object(Ee.a)(Object(Ee.a)({},e.shoppingCart),{},{numItems:e.shoppingCart.numItems+n,orderTotal:e.shoppingCart.orderTotal+n*o.price,cartItems:he(r,l,c)})},ye=function(e,t){if(void 0===e)return{cartItems:[],orderTotal:0,numItems:0};switch(t.type){case"BOOK_ADDED_TO_CART":return ge(e,t.payload,1);case"BOOK_REMOVED_FROM_CART":return ge(e,t.payload,-1);case"ALL_BOOKS_REMOVED_FROM_CART":var n=e.shoppingCart.cartItems.find((function(e){return e.id===t.payload}));return ge(e,t.payload,-n.count);case"UPDATE_SHOPPING_CART":return Object(Ee.a)(Object(Ee.a)({},e.shoppingCart),{},{cartItems:t.payload.cartItems,orderTotal:t.payload.orderTotal,numItems:t.payload.numItems});case"CLEAR_SHOPPING_CART":return Object(Ee.a)(Object(Ee.a)({},e.shoppingCart),{},{cartItems:[],orderTotal:0,numItems:0});default:return e.shoppingCart}},Ce=function(e,t){if(void 0===e)return{term:"",filterBy:"all"};switch(t.type){case"BOOKS_SEARCH":return Object(Ee.a)(Object(Ee.a)({},e.filter),{},{term:t.payload});case"SET_FILTER":return Object(Ee.a)(Object(Ee.a)({},e.filter),{},{filterBy:t.payload});default:return e.filter}},ke=function(e,t){return{bookList:be(e,t),shoppingCart:ye(e,t),filter:Ce(e,t)}},ve=Object(f.c)(ke,Object(f.a)(de.a,(function(){return function(e){return function(t){return e("string"===typeof t?{type:t}:t)}}}),(function(){return function(e){return function(t){return console.group("Dispatching: "),console.log("Action: ",t.type),t.payload&&console.log("Payload: ",t.payload),console.groupEnd(),e(t)}}}))),Se=new fe;c.a.render(r.a.createElement(l.a,{store:ve},r.a.createElement(se,null,r.a.createElement(S,{value:Se},r.a.createElement(i.a,null,r.a.createElement(ue,null))))),document.getElementById("root"))}},[[171,1,2]]]);
//# sourceMappingURL=main.bec81e03.chunk.js.map